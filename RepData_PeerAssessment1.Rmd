---
title: 'Reproducible Research: Peer Assessment 1'
author: "Xinyu W"
date: "7/14/2020"
output: html_document
---
## Loading and preprocessing the data

First, turn the warnings off

```{r setoptions, echo=TRUE}
library(knitr)
opts_chunk$set(warning = FALSE)
```


1. Load the data (i.e. read.csv())

```{r loadData, echo=TRUE}
activity <- read.csv("activity.csv")
names(activity)
head(activity,6)
```

2. Process/transform the data (if necessary) into a format suitable for your analysis

```{r transformData, echo=TRUE}
activity$date <- as.POSIXct(activity$date, "%Y-%m%d")
activity$weekday <- weekdays(activity$date)

summary(activity)
```

## What is mean total number of steps taken per day?

For this part of the assignment, you can ignore the missing values in the dataset.

```{r plot1Data, echo=TRUE}
#subset the total steps and dates from activity
plot1Data <- data.frame(tapply(activity$steps, activity$date, sum, na.rm=TRUE))
names(plot1Data)[[1]] <- "Total steps"
plot1Data$date <- rownames(plot1Data)
rownames(plot1Data) <- NULL

head(plot1Data,3)

```

1. Make a histogram of the total number of steps taken each day
```{r plot1.png, echo=TRUE}
#Histogram of total number of steps taken each day
png("plot1.png")
hist(plot1Data$`Total steps`, main = "Total Number of Steps Taken Per Day", xlab = "Total Steps", col = "steelblue", ylim = c(0,30))
dev.off()

#print plot1 here
hist(plot1Data$`Total steps`, main = "Total Number of Steps Taken Per Day", xlab = "Total Steps", col = "steelblue", ylim = c(0,30))

```

**Note**: If you do not understand the difference between a histogram and a barplot, research the difference between them.  
(*Here is the barplot of total number of steps taken per day*)

```{r plot1bar, echo=TRUE}
#make a barplot using ggplot2 system
library(ggplot2)
png("plot1barplot.png", width = 1080, height = 480)
g1 <- ggplot(aes(y = `Total steps`, x = date), data = plot1Data)
g1 + geom_bar(stat = "identity") + ylab("Total Steps") + xlab("Date") + ggtitle("Total Number of Steps Taken Per Day")
dev.off()

#print the barplot here
g1 + geom_bar(stat = "identity") + ylab("Total Steps") + xlab("Date")+ ggtitle("Total Number of Steps Taken Per Day")

```


2. Calculate and report the mean and median total number of steps taken per day

Here are the mean and median total number of steps taken per day.  
**Note: I set the days that contain no steps as "0" instead of "NA" to calculate the mean and median.**

```{r meanAndMedian, echo=TRUE}
#Calculate the mean and median
stepsMean <- mean(plot1Data$`Total steps`)
stepsMedian <- median(plot1Data$`Total steps`)

#print the result
paste("The mean of total number of steps taken per day is", stepsMean)
paste("And the median of total number of steps taken per day is", stepsMedian)

```

**Another situation: if I took zero steps as "NA"**

```{r echo=TRUE}
temp <- aggregate(steps~date, activity, sum)
mean2 <- mean(temp$steps)
median2 <- median(temp$steps)

paste("If I took zero steps as NA to calculate the mean and median, then I will get", mean2, "as mean and", median2, "as median.")

```


## What is the average daily activity pattern?

1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r plot2.png, echo=TRUE}
#Calculate the average number of steps taken

plot2Data <- aggregate(steps~interval, activity, mean)

#create and export plot2.png
png("plot2.png", width = 720, height = 480)
with(plot2Data, plot(interval, steps, type = "l", col = "steelblue", lwd = 1.5, xlab = "Interval", ylab = "Average Number of Steps", main = "Average Numbse of Steps Taken Per Interval"))
dev.off()

#print the plot2 here
with(plot2Data, plot(interval, steps, type = "l", col = "steelblue", lwd = 1.5, xlab = "Interval", ylab = "Average Number of Steps", main = "Average Numbse of Steps Taken Per Interval"))
```


2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r findmax, echo=TRUE}
intervalMax <- plot2Data[which.max(plot2Data$steps),]$interval

paste("The interval", intervalMax, "contains the maximum number of steps")
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
